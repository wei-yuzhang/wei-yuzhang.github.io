<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>使用技巧 | QuickShare</title>
    <meta name="description" content="快享前端开发团队技能分享记录">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.ab452910.css" as="style"><link rel="preload" href="/assets/js/app.a2af755d.js" as="script"><link rel="preload" href="/assets/js/2.57fa4a44.js" as="script"><link rel="preload" href="/assets/js/22.82c63883.js" as="script"><link rel="preload" href="/assets/js/11.1b48c078.js" as="script"><link rel="prefetch" href="/assets/js/10.e7bf3bd9.js"><link rel="prefetch" href="/assets/js/12.34efced5.js"><link rel="prefetch" href="/assets/js/13.19a87b93.js"><link rel="prefetch" href="/assets/js/14.9a518c45.js"><link rel="prefetch" href="/assets/js/15.3f914c70.js"><link rel="prefetch" href="/assets/js/16.07293b3a.js"><link rel="prefetch" href="/assets/js/17.88fe67e7.js"><link rel="prefetch" href="/assets/js/18.605561b1.js"><link rel="prefetch" href="/assets/js/19.c9bac71f.js"><link rel="prefetch" href="/assets/js/20.cc05a5ea.js"><link rel="prefetch" href="/assets/js/21.bc5e27f1.js"><link rel="prefetch" href="/assets/js/23.ad576338.js"><link rel="prefetch" href="/assets/js/24.619617be.js"><link rel="prefetch" href="/assets/js/25.3f80496a.js"><link rel="prefetch" href="/assets/js/26.ebc9b5c1.js"><link rel="prefetch" href="/assets/js/27.aa14a92a.js"><link rel="prefetch" href="/assets/js/28.9fd50c24.js"><link rel="prefetch" href="/assets/js/29.87e12211.js"><link rel="prefetch" href="/assets/js/3.c1ae5173.js"><link rel="prefetch" href="/assets/js/30.f1a6bead.js"><link rel="prefetch" href="/assets/js/31.77704bb6.js"><link rel="prefetch" href="/assets/js/32.1a4931cf.js"><link rel="prefetch" href="/assets/js/33.4a0f581e.js"><link rel="prefetch" href="/assets/js/34.721b85a8.js"><link rel="prefetch" href="/assets/js/35.544adad4.js"><link rel="prefetch" href="/assets/js/36.b90bda9d.js"><link rel="prefetch" href="/assets/js/37.7d0b399d.js"><link rel="prefetch" href="/assets/js/38.768c5ace.js"><link rel="prefetch" href="/assets/js/39.c8fe7016.js"><link rel="prefetch" href="/assets/js/4.357c0ae1.js"><link rel="prefetch" href="/assets/js/40.ec422e2a.js"><link rel="prefetch" href="/assets/js/41.da78aceb.js"><link rel="prefetch" href="/assets/js/42.db9d27c2.js"><link rel="prefetch" href="/assets/js/43.247130fb.js"><link rel="prefetch" href="/assets/js/44.5e7e4309.js"><link rel="prefetch" href="/assets/js/45.57372968.js"><link rel="prefetch" href="/assets/js/46.53856c2a.js"><link rel="prefetch" href="/assets/js/47.995abd15.js"><link rel="prefetch" href="/assets/js/48.a23ca278.js"><link rel="prefetch" href="/assets/js/49.fec3139d.js"><link rel="prefetch" href="/assets/js/5.b5d89564.js"><link rel="prefetch" href="/assets/js/50.46e8d088.js"><link rel="prefetch" href="/assets/js/51.75b67157.js"><link rel="prefetch" href="/assets/js/6.19904668.js"><link rel="prefetch" href="/assets/js/7.506fcdb5.js"><link rel="prefetch" href="/assets/js/8.f1cfdf45.js"><link rel="prefetch" href="/assets/js/9.c1b7fe2f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ab452910.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">QuickShare</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/knowledge/xuxiaomei/aboutVue.html" class="nav-link">Share</a></div><div class="nav-item"><a href="/baseComponents/updateLog.html" class="nav-link">Components</a></div><div class="nav-item"><a href="/aboutWebpack/" class="nav-link">Webpack</a></div><div class="nav-item"><a href="/autoTesting/introduce.html" class="nav-link">AutoTesting</a></div><div class="nav-item"><a href="/frame/" class="nav-link">Frame</a></div><div class="nav-item"><a href="/public/updateLog.html" class="nav-link">Public</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/knowledge/xuxiaomei/aboutVue.html" class="nav-link">Share</a></div><div class="nav-item"><a href="/baseComponents/updateLog.html" class="nav-link">Components</a></div><div class="nav-item"><a href="/aboutWebpack/" class="nav-link">Webpack</a></div><div class="nav-item"><a href="/autoTesting/introduce.html" class="nav-link">AutoTesting</a></div><div class="nav-item"><a href="/frame/" class="nav-link">Frame</a></div><div class="nav-item"><a href="/public/updateLog.html" class="nav-link">Public</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>自动化测试</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/autoTesting/introduce.html" class="sidebar-link">介绍</a></li><li><a href="/autoTesting/guid.html" class="sidebar-link">使用指南</a></li><li><a href="/autoTesting/skill.html" class="active sidebar-link">使用技巧</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/autoTesting/skill.html#使用场景" class="sidebar-link">使用场景</a></li><li class="sidebar-sub-header"><a href="/autoTesting/skill.html#测试哪些" class="sidebar-link">测试哪些</a></li><li class="sidebar-sub-header"><a href="/autoTesting/skill.html#断言触发的事件" class="sidebar-link">断言触发的事件</a></li><li class="sidebar-sub-header"><a href="/autoTesting/skill.html#从子组件触发事件" class="sidebar-link">从子组件触发事件</a></li><li class="sidebar-sub-header"><a href="/autoTesting/skill.html#操作组件状态" class="sidebar-link">操作组件状态</a></li><li class="sidebar-sub-header"><a href="/autoTesting/skill.html#仿造-prop" class="sidebar-link">仿造 Prop</a></li><li class="sidebar-sub-header"><a href="/autoTesting/skill.html#应用全局的插件和混入" class="sidebar-link">应用全局的插件和混入</a></li><li class="sidebar-sub-header"><a href="/autoTesting/skill.html#仿造注入" class="sidebar-link">仿造注入</a></li><li class="sidebar-sub-header"><a href="/autoTesting/skill.html#存根组件" class="sidebar-link">存根组件</a></li><li class="sidebar-sub-header"><a href="/autoTesting/skill.html#触发事件" class="sidebar-link">触发事件</a></li><li class="sidebar-sub-header"><a href="/autoTesting/skill.html#鼠标点击示例" class="sidebar-link">鼠标点击示例</a></li><li class="sidebar-sub-header"><a href="/autoTesting/skill.html#键盘示例" class="sidebar-link">键盘示例</a></li></ul></li><li><a href="/autoTesting/api.html" class="sidebar-link">API</a></li><li><a href="/autoTesting/wrapper.html" class="sidebar-link">Wrapper</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><!----> <h1 id="使用技巧"><a href="#使用技巧" aria-hidden="true" class="header-anchor">#</a> 使用技巧</h1> <p>常见的测试的使用方法，详细可以查看官方文档 <a href="https://vue-test-utils.vuejs.org/zh/guides/#%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7" title="点击这里" target="_blank" rel="noopener noreferrer">点击这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h2 id="使用场景"><a href="#使用场景" aria-hidden="true" class="header-anchor">#</a> 使用场景</h2> <p>当前的软件市场环境中，不管是用的瀑布模式，还是螺旋模式，还是敏捷模式，很多软件没有写单元测试。
对于写单元测试来说，确实需要很多时间和精力，因为它也需要设计用例和一些体力活。</p> <ul><li><p>所以在我们的一些项目中也存在很多功能没有单元测试，主要原因有以下几个点:</p> <ul><li>业务逻辑更新太快，单元测试不可复用</li> <li>业务时间紧急，迭代周期时间短，没有时间写单元测试</li> <li>UI 上很多测试，通过单元测试代码无法覆盖</li></ul></li> <li><p>但是对于满足以下几点代码我建议需要编写单元测试：</p> <ul><li>和安全相关的代码逻辑</li> <li>短期不会发生变化的 UI 组件</li> <li>提供外部调用的接口</li></ul></li></ul> <p>所以对于以上部分需不需测试，取决于你软件性质，时间和团队。</p> <h2 id="测试哪些"><a href="#测试哪些" aria-hidden="true" class="header-anchor">#</a> 测试哪些</h2> <p>主要考虑几个点：</p> <ul><li>组件的方法测试</li> <li>组件 props 的测试</li> <li>组件 UI 的更新测试（异步的）</li> <li>组件通信的测试</li></ul> <h2 id="断言触发的事件"><a href="#断言触发的事件" aria-hidden="true" class="header-anchor">#</a> 断言触发的事件</h2> <p>每个挂载的包裹器都会通过其背后的 Vue 实例自动记录所有被触发的事件。你可以用 wrapper.emitted() 方法取回这些事件记录。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'increment'</span><span class="token punctuation">)</span>
  wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'increment'</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>然后你可以基于这些数据来设置断言：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token comment">// 断言事件已经被触发</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">emitted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeTruthy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// 断言事件的数量</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">emitted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>foo<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

  <span class="token comment">// 断言事件的有效数据</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">emitted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>foo<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>你也可以调用 wrapper.emittedByOrder() 获取一个按触发先后排序的事件数组。</p> <h2 id="从子组件触发事件"><a href="#从子组件触发事件" aria-hidden="true" class="header-anchor">#</a> 从子组件触发事件</h2> <p>你可以通过访问子组件实例来触发一个自定义事件
<strong>待测试的组件</strong></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>child-component</span> <span class="token attr-name">@custom</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>onCustom<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>emitted<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Emitted!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">import</span> ChildComponent <span class="token keyword">from</span> <span class="token string">'./ChildComponent'</span>
    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
      name<span class="token punctuation">:</span> <span class="token string">'ParentComponent'</span><span class="token punctuation">,</span>
      components<span class="token punctuation">:</span> <span class="token punctuation">{</span> ChildComponent <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          emitted<span class="token punctuation">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token function">onCustom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>emitted <span class="token operator">=</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><strong>测试代码</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> shallowMount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> ParentComponent <span class="token keyword">from</span> <span class="token string">'@/components/ParentComponent'</span>
  <span class="token keyword">import</span> ChildComponent <span class="token keyword">from</span> <span class="token string">'@/components/ChildComponent'</span>

  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'ParentComponent'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;displays 'Emitted!' when custom event is emitted&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">shallowMount</span><span class="token punctuation">(</span>ParentComponent<span class="token punctuation">)</span>
      wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>ChildComponent<span class="token punctuation">)</span><span class="token punctuation">.</span>vm<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'custom'</span><span class="token punctuation">)</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">'Emitted!'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="操作组件状态"><a href="#操作组件状态" aria-hidden="true" class="header-anchor">#</a> 操作组件状态</h2> <p>你可以在包裹器上用 setData 或 setProps 方法直接操作组件状态：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  wrapper<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> count<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

  wrapper<span class="token punctuation">.</span><span class="token function">setProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span> foo<span class="token punctuation">:</span> <span class="token string">'bar'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="仿造-prop"><a href="#仿造-prop" aria-hidden="true" class="header-anchor">#</a> 仿造 Prop</h2> <p>你可以使用 Vue 在内置 propsData 选项向组件传入 prop：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>

  <span class="token function">mount</span><span class="token punctuation">(</span>Component<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    propsData<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      aProp<span class="token punctuation">:</span> <span class="token string">'some value'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>你也可以用 wrapper.setProps({}) 方法更新这些已经挂载的组件的 prop</p> <h2 id="应用全局的插件和混入"><a href="#应用全局的插件和混入" aria-hidden="true" class="header-anchor">#</a> 应用全局的插件和混入</h2> <p>有些组件可能依赖一个全局插件或混入 (mixin) 的功能注入，比如 vuex 和 vue-router。</p> <p>如果你在为一个特定的应用撰写组件，你可以在你的测试入口处一次性设置相同的全局插件和混入。但是有些情况下，比如测试一个可能会跨越不同应用共享的普通的组件套件的时候，最好还是在一个更加隔离的设置中测试你的组件，不对全局的 Vue 构造函数注入任何东西。我们可以使用 createLocalVue 方法来存档它们：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> createLocalVue <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>

  <span class="token comment">// 创建一个扩展的 `Vue` 构造函数</span>
  <span class="token keyword">const</span> localVue <span class="token operator">=</span> <span class="token function">createLocalVue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// 正常安装插件</span>
  localVue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>MyPlugin<span class="token punctuation">)</span>

  <span class="token comment">// 在挂载选项中传入 `localVue`</span>
  <span class="token function">mount</span><span class="token punctuation">(</span>Component<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    localVue
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>注意有些插件会为全局的 Vue 构造函数添加只读属性，比如 Vue Router。这使得我们无法在一个 localVue 构造函数上二次安装该插件，或伪造这些只读属性。</strong></p> <h2 id="仿造注入"><a href="#仿造注入" aria-hidden="true" class="header-anchor">#</a> 仿造注入</h2> <p>另一个注入 prop 的策略就是简单的仿造它们。你可以使用 mocks 选项：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>

  <span class="token keyword">const</span> $route <span class="token operator">=</span> <span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    hash<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    params<span class="token punctuation">:</span> <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token string">'123'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    query<span class="token punctuation">:</span> <span class="token punctuation">{</span> q<span class="token punctuation">:</span> <span class="token string">'hello'</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">mount</span><span class="token punctuation">(</span>Component<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    mocks<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 在挂载组件之前</span>
      <span class="token comment">// 添加仿造的 `$route` 对象到 Vue 实例中</span>
      $route
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="存根组件"><a href="#存根组件" aria-hidden="true" class="header-anchor">#</a> 存根组件</h2> <p>你可以使用 stubs 选项覆写全局或局部注册的组件：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>

  <span class="token function">mount</span><span class="token punctuation">(</span>Component<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// 将会把 globally-registered-component 解析为</span>
    <span class="token comment">// 空的存根</span>
    stubs<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'globally-registered-component'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="触发事件"><a href="#触发事件" aria-hidden="true" class="header-anchor">#</a> 触发事件</h2> <p>Wrapper 暴露了一个 trigger 方法。它可以用来触发 DOM 事件。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>MyButton<span class="token punctuation">)</span>

wrapper<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>你应该注意到了，find 方法也会返回一个 Wrapper。假设 MyComponent 包含一个按钮，下面的代码会点击这个按钮。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>MyComponent<span class="token punctuation">)</span>

wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="鼠标点击示例"><a href="#鼠标点击示例" aria-hidden="true" class="header-anchor">#</a> 鼠标点击示例</h2> <p><strong>待测试的组件</strong></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>yes<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>callYes<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Yes<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>no<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>callNo<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>No<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
      name<span class="token punctuation">:</span> <span class="token string">'YesNoComponent'</span><span class="token punctuation">,</span>

      props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        callMe<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          type<span class="token punctuation">:</span> Function
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token function">callYes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">callMe</span><span class="token punctuation">(</span><span class="token string">'yes'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">callNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">callMe</span><span class="token punctuation">(</span><span class="token string">'no'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p><strong>测试代码</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> YesNoComponent <span class="token keyword">from</span> <span class="token string">'@/components/YesNoComponent'</span>
  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> sinon <span class="token keyword">from</span> <span class="token string">'sinon'</span>

  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Click event'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'点击 yes 按钮函数的参数变成 yes'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> spy <span class="token operator">=</span> sinon<span class="token punctuation">.</span><span class="token function">spy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>YesNoComponent<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        propsData<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          callMe<span class="token punctuation">:</span> spy
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'button.yes'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>

      spy<span class="token punctuation">.</span>should<span class="token punctuation">.</span>have<span class="token punctuation">.</span>been<span class="token punctuation">.</span><span class="token function">calledWith</span><span class="token punctuation">(</span><span class="token string">'yes'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="键盘示例"><a href="#键盘示例" aria-hidden="true" class="header-anchor">#</a> 键盘示例</h2> <p><strong>待测试的组件</strong>
这个组件允许使用不同的按键将数量递增/递减。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@keydown.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>onKeydown<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>quantity<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
      <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          quantity<span class="token punctuation">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token function">onKeydown</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>keyCode <span class="token operator">===</span> <span class="token number">27</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>quantity <span class="token operator">=</span> <span class="token number">0</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>keyCode <span class="token operator">===</span> <span class="token number">40</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>quantity <span class="token operator">-=</span> <span class="token number">1</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>keyCode <span class="token operator">===</span> <span class="token number">38</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>quantity <span class="token operator">+=</span> <span class="token number">1</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>key <span class="token operator">===</span> <span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>quantity <span class="token operator">=</span> <span class="token number">13</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      watch<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">quantity</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> newValue<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p><strong>测试代码</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> QuantityComponent <span class="token keyword">from</span> <span class="token string">'@/components/QuantityComponent'</span>
  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>

  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Key event tests'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'初始值为 0'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>QuantityComponent<span class="token punctuation">)</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>quantity<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'Up 按键数字加 1'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>QuantityComponent<span class="token punctuation">)</span>
      wrapper<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'keydown.up'</span><span class="token punctuation">)</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>quantity<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'Down 按键数字减 1'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>QuantityComponent<span class="token punctuation">)</span>
      wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>quantity <span class="token operator">=</span> <span class="token number">5</span>
      wrapper<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'keydown.down'</span><span class="token punctuation">)</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>quantity<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'Escape 按键数字回复初始值 0'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>QuantityComponent<span class="token punctuation">)</span>
      wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>quantity <span class="token operator">=</span> <span class="token number">5</span>
      wrapper<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'keydown.esc'</span><span class="token punctuation">)</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>quantity<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'a 按键数字 13'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>QuantityComponent<span class="token punctuation">)</span>
      wrapper<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'keydown'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        key<span class="token punctuation">:</span> <span class="token string">'a'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>quantity<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p><strong>限制</strong> <br></p> <p>点后面的按键名 keydown.up 会被翻译成一个 keyCode。这些被支持的按键名有：
<table class="table-special"><thead><tr><th>key name</th><th>key code</th></tr></thead> <tbody><tr><td>enter</td><td>13</td></tr> <tr><td>esc</td><td>27</td></tr> <tr><td>tab</td><td>9</td></tr> <tr><td>space</td><td>32</td></tr> <tr><td>delete</td><td>46</td></tr> <tr><td>backspace</td><td>8</td></tr> <tr><td>insert</td><td>45</td></tr> <tr><td>up</td><td>38</td></tr> <tr><td>down</td><td>40</td></tr> <tr><td>left</td><td>37</td></tr> <tr><td>right</td><td>39</td></tr> <tr><td>end</td><td>35</td></tr> <tr><td>home</td><td>36</td></tr> <tr><td>pageup</td><td>33</td></tr> <tr><td>pagedown</td><td>34</td></tr></tbody></table></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/autoTesting/guid.html" class="prev">
          使用指南
        </a></span> <span class="next"><a href="/autoTesting/api.html">
          API
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a2af755d.js" defer></script><script src="/assets/js/2.57fa4a44.js" defer></script><script src="/assets/js/22.82c63883.js" defer></script><script src="/assets/js/11.1b48c078.js" defer></script>
  </body>
</html>
