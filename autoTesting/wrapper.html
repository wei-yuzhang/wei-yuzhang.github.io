<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Wrapper | QuickShare</title>
    <meta name="description" content="快享前端开发团队技能分享记录">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.ab452910.css" as="style"><link rel="preload" href="/assets/js/app.a2af755d.js" as="script"><link rel="preload" href="/assets/js/2.57fa4a44.js" as="script"><link rel="preload" href="/assets/js/23.ad576338.js" as="script"><link rel="preload" href="/assets/js/11.1b48c078.js" as="script"><link rel="prefetch" href="/assets/js/10.e7bf3bd9.js"><link rel="prefetch" href="/assets/js/12.34efced5.js"><link rel="prefetch" href="/assets/js/13.19a87b93.js"><link rel="prefetch" href="/assets/js/14.9a518c45.js"><link rel="prefetch" href="/assets/js/15.3f914c70.js"><link rel="prefetch" href="/assets/js/16.07293b3a.js"><link rel="prefetch" href="/assets/js/17.88fe67e7.js"><link rel="prefetch" href="/assets/js/18.605561b1.js"><link rel="prefetch" href="/assets/js/19.c9bac71f.js"><link rel="prefetch" href="/assets/js/20.cc05a5ea.js"><link rel="prefetch" href="/assets/js/21.bc5e27f1.js"><link rel="prefetch" href="/assets/js/22.82c63883.js"><link rel="prefetch" href="/assets/js/24.619617be.js"><link rel="prefetch" href="/assets/js/25.3f80496a.js"><link rel="prefetch" href="/assets/js/26.ebc9b5c1.js"><link rel="prefetch" href="/assets/js/27.aa14a92a.js"><link rel="prefetch" href="/assets/js/28.9fd50c24.js"><link rel="prefetch" href="/assets/js/29.87e12211.js"><link rel="prefetch" href="/assets/js/3.c1ae5173.js"><link rel="prefetch" href="/assets/js/30.f1a6bead.js"><link rel="prefetch" href="/assets/js/31.77704bb6.js"><link rel="prefetch" href="/assets/js/32.1a4931cf.js"><link rel="prefetch" href="/assets/js/33.4a0f581e.js"><link rel="prefetch" href="/assets/js/34.721b85a8.js"><link rel="prefetch" href="/assets/js/35.544adad4.js"><link rel="prefetch" href="/assets/js/36.b90bda9d.js"><link rel="prefetch" href="/assets/js/37.7d0b399d.js"><link rel="prefetch" href="/assets/js/38.768c5ace.js"><link rel="prefetch" href="/assets/js/39.c8fe7016.js"><link rel="prefetch" href="/assets/js/4.357c0ae1.js"><link rel="prefetch" href="/assets/js/40.ec422e2a.js"><link rel="prefetch" href="/assets/js/41.da78aceb.js"><link rel="prefetch" href="/assets/js/42.db9d27c2.js"><link rel="prefetch" href="/assets/js/43.247130fb.js"><link rel="prefetch" href="/assets/js/44.5e7e4309.js"><link rel="prefetch" href="/assets/js/45.57372968.js"><link rel="prefetch" href="/assets/js/46.53856c2a.js"><link rel="prefetch" href="/assets/js/47.995abd15.js"><link rel="prefetch" href="/assets/js/48.a23ca278.js"><link rel="prefetch" href="/assets/js/49.fec3139d.js"><link rel="prefetch" href="/assets/js/5.b5d89564.js"><link rel="prefetch" href="/assets/js/50.46e8d088.js"><link rel="prefetch" href="/assets/js/51.75b67157.js"><link rel="prefetch" href="/assets/js/6.19904668.js"><link rel="prefetch" href="/assets/js/7.506fcdb5.js"><link rel="prefetch" href="/assets/js/8.f1cfdf45.js"><link rel="prefetch" href="/assets/js/9.c1b7fe2f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ab452910.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">QuickShare</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/knowledge/xuxiaomei/aboutVue.html" class="nav-link">Share</a></div><div class="nav-item"><a href="/baseComponents/updateLog.html" class="nav-link">Components</a></div><div class="nav-item"><a href="/aboutWebpack/" class="nav-link">Webpack</a></div><div class="nav-item"><a href="/autoTesting/introduce.html" class="nav-link">AutoTesting</a></div><div class="nav-item"><a href="/frame/" class="nav-link">Frame</a></div><div class="nav-item"><a href="/public/updateLog.html" class="nav-link">Public</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/knowledge/xuxiaomei/aboutVue.html" class="nav-link">Share</a></div><div class="nav-item"><a href="/baseComponents/updateLog.html" class="nav-link">Components</a></div><div class="nav-item"><a href="/aboutWebpack/" class="nav-link">Webpack</a></div><div class="nav-item"><a href="/autoTesting/introduce.html" class="nav-link">AutoTesting</a></div><div class="nav-item"><a href="/frame/" class="nav-link">Frame</a></div><div class="nav-item"><a href="/public/updateLog.html" class="nav-link">Public</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>自动化测试</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/autoTesting/introduce.html" class="sidebar-link">介绍</a></li><li><a href="/autoTesting/guid.html" class="sidebar-link">使用指南</a></li><li><a href="/autoTesting/skill.html" class="sidebar-link">使用技巧</a></li><li><a href="/autoTesting/api.html" class="sidebar-link">API</a></li><li><a href="/autoTesting/wrapper.html" class="active sidebar-link">Wrapper</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#属性" class="sidebar-link">属性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#vm" class="sidebar-link">vm</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#element" class="sidebar-link">element</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#options" class="sidebar-link">options</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#options-sync" class="sidebar-link">options.sync</a></li></ul></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#attributes" class="sidebar-link">attributes</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#classes" class="sidebar-link">classes</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#contains" class="sidebar-link">contains</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#destroy" class="sidebar-link">destroy</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#emitted" class="sidebar-link">emitted</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#find" class="sidebar-link">find</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#html" class="sidebar-link">html</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#is" class="sidebar-link">is</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#isempty" class="sidebar-link">isEmpty</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#name" class="sidebar-link">name</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#props" class="sidebar-link">props</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#setchecked" class="sidebar-link">setChecked</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#setdata" class="sidebar-link">setData</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#setmethods" class="sidebar-link">setMethods</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#setprops" class="sidebar-link">setProps</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#setselected" class="sidebar-link">setSelected</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#setvalue" class="sidebar-link">setValue</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#text" class="sidebar-link">text</a></li><li class="sidebar-sub-header"><a href="/autoTesting/wrapper.html#trigger" class="sidebar-link">trigger</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><!----> <h1 id="wrapper"><a href="#wrapper" aria-hidden="true" class="header-anchor">#</a> Wrapper</h1> <p>Vue Test Utils 是一个基于包裹器的 API。</p> <p>一个 Wrapper 是一个包括了一个挂载组件或 vnode，以及测试该组件或 vnode 的方法。</p> <p>这里对几个常用的方法进行简介，官方文档请 <a href="https://vue-test-utils.vuejs.org/zh/api/wrapper/" title="点击这里" target="_blank" rel="noopener noreferrer">点击这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h2 id="属性"><a href="#属性" aria-hidden="true" class="header-anchor">#</a> 属性</h2> <h3 id="vm"><a href="#vm" aria-hidden="true" class="header-anchor">#</a> vm</h3> <p>Component (只读)：这是该 Vue 实例。你可以通过 wrapper.vm 访问一个实例所有的方法和属性。这只存在于 Vue 组件包裹器或绑定了 Vue 组件包裹器的 HTMLElement 中。</p> <h3 id="element"><a href="#element" aria-hidden="true" class="header-anchor">#</a> element</h3> <p>HTMLElement (只读)：包裹器的根 DOM 节点</p> <h3 id="options"><a href="#options" aria-hidden="true" class="header-anchor">#</a> options</h3> <p>Boolean (只读)：如果组件在渲染之后被添加到了文档上则为真</p> <h3 id="options-sync"><a href="#options-sync" aria-hidden="true" class="header-anchor">#</a> options.sync</h3> <p>Boolean (只读)：如果挂载选项里的 sync 不是 false 则为真</p> <h2 id="attributes"><a href="#attributes" aria-hidden="true" class="header-anchor">#</a> attributes</h2> <p>返回 Wrapper DOM 节点的特性对象。如果提供了 key，则返回这个 key 对应的值。</p> <ul><li><p><strong>参数：</strong> {string} key 可选的</p></li> <li><p><strong>返回值：</strong> {[attribute: string]: any} | string</p></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="classes"><a href="#classes" aria-hidden="true" class="header-anchor">#</a> classes</h2> <p>返回 Wrapper DOM 节点的 class。</p> <p>返回 class 名称的数组。或在提供 class 名的时候返回一个布尔值。</p> <ul><li><p><strong>参数：</strong> {string} className 可选的</p></li> <li><p><strong>返回值：</strong> Array&lt;{string}&gt; | boolean</p></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">classes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
<span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">classes</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="contains"><a href="#contains" aria-hidden="true" class="header-anchor">#</a> contains</h2> <p>判断 Wrapper 是否包含了一个匹配<a href="/autoTesting/wrapper.html#选择器" title="选择器">选择器</a>的元素或组件。</p> <p>返回 class 名称的数组。或在提供 class 名的时候返回一个布尔值。</p> <ul><li><p><strong>参数：</strong> {string|Component} selector</p></li> <li><p><strong>返回值：</strong> {boolean}</p></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>
  <span class="token keyword">import</span> Bar <span class="token keyword">from</span> <span class="token string">'./Bar.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>Bar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="destroy"><a href="#destroy" aria-hidden="true" class="header-anchor">#</a> destroy</h2> <p>销毁一个 Vue 组件实例。</p> <ul><li><strong>示例：</strong></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> sinon <span class="token keyword">from</span> <span class="token string">'sinon'</span>

  <span class="token keyword">const</span> spy <span class="token operator">=</span> sinon<span class="token punctuation">.</span><span class="token function">stub</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">mount</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    render<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token function">destroyed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">spy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>spy<span class="token punctuation">.</span>calledOnce<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>如果挂载时 attachToDocument 被设为 true，则组件的 DOM 元素也将会从文档中被移除。</p> <p>对于函数式组件来说，destroy 只会从文档中移除渲染出来的 DOM 元素。</p> <h2 id="emitted"><a href="#emitted" aria-hidden="true" class="header-anchor">#</a> emitted</h2> <p>返回一个包含由 Wrapper vm 触发的自定义事件的对象。</p> <ul><li><p><strong>返回值：</strong> { [name: string]: Array&lt;Array&lt;any&gt;&gt; }</p></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span>

  wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span>
  wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span>

  <span class="token comment">/*
  `wrapper.emitted() 返回如下对象：
  {
    foo: [[], [123]]
  }
  */</span>

  <span class="token comment">// 断言事件已经被触发</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">emitted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeTruthy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// 断言事件的数量</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">emitted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>foo<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

  <span class="token comment">// 断言事件的有效数据</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">emitted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>foo<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>你也可以把上面的代码写成这样：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token comment">// 断言事件已经被触发</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">emitted</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeTruthy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// 断言事件的数量</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">emitted</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

  <span class="token comment">// 断言事件的有效数据</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">emitted</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>该 .emitted() 方法每次被调用时都返回相同的对象，而不是返回一个新的，所以当新事件被触发时该对象会被更新：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">const</span> emitted <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">emitted</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>emitted<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

  <span class="token comment">// 想办法让 `wrapper` 触发 &quot;foo&quot; 事件</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>emitted<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="find"><a href="#find" aria-hidden="true" class="header-anchor">#</a> find</h2> <p>返回匹配选择器的第一个 DOM 节点或 Vue 组件的 Wrapper。</p> <p>可以使用任何有效的<a href="/autoTesting/wrapper.html#选择器" title="选择器">选择器</a></p> <ul><li><p><strong>参数：</strong> {string|Component} selector</p></li> <li><p><strong>返回值：</strong> {Wrapper}</p></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>
  <span class="token keyword">import</span> Bar <span class="token keyword">from</span> <span class="token string">'./Bar.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span>

  <span class="token keyword">const</span> div <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> bar <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>Bar<span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>bar<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span>Bar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> barByName <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'bar'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>barByName<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span>Bar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> fooRef <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> ref<span class="token punctuation">:</span> <span class="token string">'foo'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>fooRef<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="html"><a href="#html" aria-hidden="true" class="header-anchor">#</a> html</h2> <p>返回 Wrapper DOM 节点的 HTML 字符串。</p> <ul><li><p><strong>返回值：</strong> {string}</p></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'&lt;div&gt;&lt;p&gt;Foo&lt;/p&gt;&lt;/div&gt;'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="is"><a href="#is" aria-hidden="true" class="header-anchor">#</a> is</h2> <p>断言 Wrapper DOM 节点或 vm 匹配<a href="/autoTesting/wrapper.html#选择器" title="选择器">选择器</a>。</p> <ul><li><p><strong>参数：</strong> {string|Component} selector</p></li> <li><p><strong>返回值：</strong> {boolean}</p></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="isempty"><a href="#isempty" aria-hidden="true" class="header-anchor">#</a> isEmpty</h2> <p>断言 Wrapper 并不包含子节点。</p> <ul><li><p><strong>返回值：</strong> {boolean}</p></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="name"><a href="#name" aria-hidden="true" class="header-anchor">#</a> name</h2> <p>如果 Wrapper 包含一个 Vue 实例则返回组件名，否则返回 Wrapper DOM 节点的标签名。</p> <ul><li><p><strong>返回值：</strong> {string}</p></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'Foo'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> p <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="props"><a href="#props" aria-hidden="true" class="header-anchor">#</a> props</h2> <p>返回 Wrapper vm 的 props 对象。如果提供了 key，则返回这个 key 对应的值。
<strong>注意：该包裹器必须包含一个 Vue 实例。</strong></p> <ul><li><p><strong>参数：</strong> {string} key 可选的</p></li> <li><p><strong>返回值：</strong> {[prop: string]: any} | any</p></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    propsData<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      bar<span class="token punctuation">:</span> <span class="token string">'baz'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">props</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>bar<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'baz'</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">props</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'baz'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="setchecked"><a href="#setchecked" aria-hidden="true" class="header-anchor">#</a> setChecked</h2> <p>设置 checkbox 或 radio 类 Input 元素的 checked 值并更新 v-model 绑定的数据。</p> <ul><li><p><strong>参数：</strong> {Boolean} checked (默认值：true)</p></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span>
  <span class="token keyword">const</span> radioInput <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'input[type=&quot;radio&quot;]'</span><span class="token punctuation">)</span>
  radioInput<span class="token punctuation">.</span><span class="token function">setChecked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="tip custom-block"><p>当你尝试通过 radioInput.element.checked = true; radioInput.trigger('input') 经由 v-model 向 state 设置值的时候，v-model 不会被触发。v-model 是被 change 事件触发的。</p></div> <p>checkboxInput.setChecked(checked) 是接下来这段代码的别名。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  checkboxInput<span class="token punctuation">.</span>element<span class="token punctuation">.</span>checked <span class="token operator">=</span> checked
  checkboxInput<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
  checkboxInput<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="setdata"><a href="#setdata" aria-hidden="true" class="header-anchor">#</a> setData</h2> <p>设置 Wrapper vm 的属性。</p> <p>setData 通过递归调用 Vue.set 生效。</p> <p><strong>注意：该包裹器必须包含一个 Vue 示例。</strong></p> <ul><li><p><strong>参数：</strong> {Object} data</p></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span>
  wrapper<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> foo<span class="token punctuation">:</span> <span class="token string">'bar'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="setmethods"><a href="#setmethods" aria-hidden="true" class="header-anchor">#</a> setMethods</h2> <p>设置 Wrapper vm 的方法并强制更新。</p> <p><strong>注意：该包裹器必须包含一个 Vue 示例。</strong></p> <ul><li><p><strong>参数：</strong> {Object} methods</p></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> sinon <span class="token keyword">from</span> <span class="token string">'sinon'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span>
  <span class="token keyword">const</span> clickMethodStub <span class="token operator">=</span> sinon<span class="token punctuation">.</span><span class="token function">stub</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  wrapper<span class="token punctuation">.</span><span class="token function">setMethods</span><span class="token punctuation">(</span><span class="token punctuation">{</span> clickMethod<span class="token punctuation">:</span> clickMethodStub <span class="token punctuation">}</span><span class="token punctuation">)</span>
  wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>clickMethodStub<span class="token punctuation">.</span>called<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="setprops"><a href="#setprops" aria-hidden="true" class="header-anchor">#</a> setProps</h2> <p>设置 Wrapper vm 的 prop 并强制更新。</p> <p><strong>注意：该包裹器必须包含一个 Vue 示例。</strong></p> <ul><li><p><strong>参数：</strong> {Object} props</p></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span>
  wrapper<span class="token punctuation">.</span><span class="token function">setProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span> foo<span class="token punctuation">:</span> <span class="token string">'bar'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>你也可以传递一个 propsData 对象，这会用该对象来初始化 Vue 示例。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token comment">// Foo.vue</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      foo<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
        required<span class="token punctuation">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    propsData<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      foo<span class="token punctuation">:</span> <span class="token string">'bar'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="setselected"><a href="#setselected" aria-hidden="true" class="header-anchor">#</a> setSelected</h2> <p>选择一个 option 元素并更新 v-model 绑定的数据。</p> <ul><li><strong>示例：</strong></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">shallowMount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span>
  <span class="token keyword">const</span> options <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'select'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token string">'option'</span><span class="token punctuation">)</span>

  options<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSelected</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><strong>注意：</strong>
当你尝试通过 option.element.selected = true; arentSelect.trigger('input') 经由 v-model 向 state 设置值的时候，v-model 不会被触发。v-model 是被 change 事件触发的。</li></ul> <p>option.setSelected() 是接下来这段代码的别名。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  option<span class="token punctuation">.</span>element<span class="token punctuation">.</span>selected <span class="token operator">=</span> <span class="token boolean">true</span>
  parentSelect<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="setvalue"><a href="#setvalue" aria-hidden="true" class="header-anchor">#</a> setValue</h2> <p>设置一个文本控件或 select 元素的值并更新 v-model 绑定的数据。</p> <ul><li><p><strong>参数：</strong> {String} value</p></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span>

  <span class="token keyword">const</span> textInput <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'input[type=&quot;text&quot;]'</span><span class="token punctuation">)</span>
  textInput<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">'some value'</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> select <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'select'</span><span class="token punctuation">)</span>
  select<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">'option value'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li><strong>注意：</strong> <ul><li>textInput.setValue(value) 是接下来这段代码的别名。</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  textInput<span class="token punctuation">.</span>element<span class="token punctuation">.</span>value <span class="token operator">=</span> value
  textInput<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>select.setValue(value) 是接下来这段代码的别名。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  select<span class="token punctuation">.</span>element<span class="token punctuation">.</span>value <span class="token operator">=</span> value
  select<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="text"><a href="#text" aria-hidden="true" class="header-anchor">#</a> text</h2> <p>返回 Wrapper 的文本内容。</p> <ul><li><p><strong>返回值：</strong> {{string}</p></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo.vue'</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="trigger"><a href="#trigger" aria-hidden="true" class="header-anchor">#</a> trigger</h2> <p>在该 Wrapper DOM 节点上触发一个事件。</p> <p>trigger 带有一个可选的 options 对象。options 对象内的属性会被添加到事件上。</p> <ul><li><p><strong>参数：</strong></p> <ul><li>{string} eventType 必填</li> <li>{Object} options 可选</li></ul></li> <li><p><strong>示例：</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
  <span class="token keyword">import</span> sinon <span class="token keyword">from</span> <span class="token string">'sinon'</span>
  <span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">'./Foo'</span>

  <span class="token keyword">const</span> clickHandler <span class="token operator">=</span> sinon<span class="token punctuation">.</span><span class="token function">stub</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Foo<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    propsData<span class="token punctuation">:</span> <span class="token punctuation">{</span> clickHandler <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  wrapper<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>

  wrapper<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    button<span class="token punctuation">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  wrapper<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    ctrlKey<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token comment">// 用于测试 @click.ctrl 处理函数</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>clickHandler<span class="token punctuation">.</span>called<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><ul><li><strong>设置事件目标：</strong></li></ul> <p>在这背后，trigger 创建了一个 Event 对象并分发到其包裹器的元素上。我们没有机会编辑 Event 对象的 target 值，所以你无法在选项对象中设置 target。如果想在 target 中添加一个特性，你需要在调用 trigger 之前设置包裹器元素的那个值。你可以通过 element 属性做到这件事。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">const</span> input <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span>
  input<span class="token punctuation">.</span>element<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">100</span>
  input<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/autoTesting/api.html" class="prev">
          API
        </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a2af755d.js" defer></script><script src="/assets/js/2.57fa4a44.js" defer></script><script src="/assets/js/23.ad576338.js" defer></script><script src="/assets/js/11.1b48c078.js" defer></script>
  </body>
</html>
